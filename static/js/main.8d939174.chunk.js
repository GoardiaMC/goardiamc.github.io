(this["webpackJsonpreact-sheets"]=this["webpackJsonpreact-sheets"]||[]).push([[0],{110:function(e,a,t){"use strict";t.r(a);var l=t(0),n=t.n(l),r=t(9),o=t.n(r),c=(t(95),t(96),t(71)),i=t(32),u=t(66),s=t(18),m=t(10),d=t(147),f=t(151),g=t(143),b=t(142),v=t(137),E=t(140),h=t(51),p=t(70),C=t.n(p),y=t(14),x=t(148),w=t(67),j=t(149),O=t(152),W=t(155),S=t(68),k=t(69),R=function(e){return M(e)?"":"".concat(e.getDate(),"/").concat(e.getMonth()+1,"/").concat(e.getFullYear())},M=function(e){return!e||""===e},N=Object(v.a)((function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},deleteRow:{"min-width":0,display:"block","margin-left":"auto","margin-right":"auto",padding:"10px 0 0 0",height:"100%",width:"100%",backgroundColor:"rgba(193, 0, 0, 0.6)"},header:{backgroundColor:"rgba(48, 45, 194, 0.83)"},tableRow:{backgroundColor:"rgba(86, 74, 144, 0.44)"},error:{color:"rgba(193, 0, 0, 0.6)"},paper:{marginTop:e.spacing(8)},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function T(){var e=N(),a=Object(l.useState)("EXTIA Portugal Lda"),t=Object(m.a)(a,2),r=t[0],o=t[1],c=Object(l.useState)("515533335"),i=Object(m.a)(c,2),v=i[0],p=i[1],T=Object(l.useState)(""),A=Object(m.a)(T,2),D=A[0],U=A[1],B=Object(l.useState)(""),F=Object(m.a)(B,2),V=F[0],H=F[1],I=Object(l.useState)(""),L=Object(m.a)(I,2),G=L[0],J=L[1],K=Object(l.useState)(""),$=Object(m.a)(K,2),P=$[0],X=$[1],q=Object(l.useState)(null),z=Object(m.a)(q,2),Y=z[0],Q=z[1],Z=Object(l.useState)(null),_=Object(m.a)(Z,2),ee=_[0],ae=_[1],te=Object(l.useState)(null),le=Object(m.a)(te,2),ne=le[0],re=le[1],oe=Object(l.useState)(""),ce=Object(m.a)(oe,2),ie=ce[0],ue=ce[1],se=Object(l.useState)("0.00"),me=Object(m.a)(se,2),de=me[0],fe=me[1],ge=Object(l.useState)(1),be=Object(m.a)(ge,2),ve=be[0],Ee=be[1],he=Object(l.useState)("Alimenta\xe7\xe3o"),pe=Object(m.a)(he,2),Ce=pe[0],ye=pe[1],xe=Object(l.useState)([]),we=Object(m.a)(xe,2),je=we[0],Oe=we[1],We=Object(l.useState)([]),Se=Object(m.a)(We,2),ke=(Se[0],Se[1]),Re=/^([1-9]\d*\.\d{1,2})|([0]\.\d{1,2}|([0-9]\d*))$/,Me=function e(a){return"undefined"===typeof e.errs&&(e.errs={},e.setState=function(){return ke(e.errs)}),a&&(e.errs=Object(u.a)({},e.errs,{},a)),e}(!1),Ne=function(){return M(ne)&&Me({date:!0}),M(ie)&&Me({description:!0}),M(ve)&&Me({multiplier:!0}),Re.test(de)||Me({price:!0}),Me.setState(),!Object.keys(Me.errs).length};function Te(){!function(e){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(e){if(200==this.status){var t=a.getResponseHeader("Content-Type"),l=new Blob([this.response],{type:t}),n=new FileReader;n.onloadend=function(e){var a=n.result;(new S.Workbook).xlsx.load(a).then((function(e){var a=e.getWorksheet("Relat\xf3rio de despesas"),t=je.length-1;a.spliceRows.apply(a,[12,0].concat(Object(s.a)(new Array(t)))),a.getRow(4).getCell(8).value=v,a.getRow(4).getCell(12).value=Y,a.getRow(5).getCell(12).value=ee,a.getRow(7).getCell(11).value=P,a.getRow(7).getCell(3).value=D,a.getRow(7).getCell(7).value=G,a.getRow(11).eachCell({includeEmpty:!0},(function(e,l){Object(s.a)(Array(t).keys()).forEach((function(t,n){a.getRow(12+n).getCell(l).style=e.style}))}));var l={Hotel:0,Transporte:1,"Combust\xedvel":2,"Alimenta\xe7\xe3o":3,Telefone:4,Entretenimento:5,Diversos:6};Object(s.a)(Array(t+1).keys()).forEach((function(e,t){var n=a.getRow(11+t);n.getCell(2).value=new Date(je[t].date),n.getCell(4).value=je[t].description;n.getCell(5+l[je[t].category]).value=parseFloat(je[t].price);n.getCell(12).value={formula:"SUM(E".concat(11+t,":K").concat(11+t,")"),result:parseFloat(je[t].price)}}));var n=a.getRow(12+t);n.getCell(5).value={formula:"SUM(E11:E".concat(11+t,")")},n.getCell(6).value={formula:"SUM(F11:F".concat(11+t,")")},n.getCell(7).value={formula:"SUM(G11:G".concat(11+t,")")},n.getCell(8).value={formula:"SUM(H11:H".concat(11+t,")")},n.getCell(9).value={formula:"SUM(I11:I".concat(11+t,")")},n.getCell(10).value={formula:"SUM(J11:J".concat(11+t,")")},n.getCell(11).value={formula:"SUM(K11:K".concat(11+t,")")},a.getRow(13+t).getCell(12).value={formula:"SUM(L11:L".concat(11+t,")")},a.getRow(15+t).getCell(12).value={formula:"(L".concat(13+t,"-L").concat(14+t,")")},e.xlsx.writeBuffer().then((function(e){var a=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Object(k.saveAs)(a,"fileName.xlsx")}))})).catch((function(e){console.error(e)}))},n.readAsArrayBuffer(l)}},a.send()}("https://raw.githubusercontent.com/GoardiaMC/ExcelAutomation/master/sheet.xlsx")}return n.a.createElement(E.a,{component:"main",maxWidth:"md"},n.a.createElement("br",null),n.a.createElement(b.a,{component:"h1",variant:"h5"},"Fill Business and Worker Information"),n.a.createElement("br",null),n.a.createElement(g.a,{container:!0,spacing:2},n.a.createElement(g.a,{item:!0,xs:12,sm:6},n.a.createElement(f.a,{fullWidth:!0,label:"Descri\xe7\xe3o",value:r,onChange:function(e){return o(e.target.value)}})),n.a.createElement(g.a,{item:!0,xs:12,sm:6},n.a.createElement(f.a,{fullWidth:!0,label:"Business Taxpayer Number",value:v,onChange:function(e){return p(e.target.value)}})),n.a.createElement(g.a,{item:!0,xs:12,sm:6},n.a.createElement(f.a,{fullWidth:!0,label:"Worker's Name",value:D,onChange:function(e){return U(e.target.value)}})),n.a.createElement(g.a,{item:!0,xs:12,sm:6},n.a.createElement(f.a,{fullWidth:!0,label:"Worker's Taxpayer Number",value:P,onChange:function(e){return X(e.target.value)}})),n.a.createElement(g.a,{item:!0,xs:12,sm:6},n.a.createElement(f.a,{fullWidth:!0,label:"Worker's Job Position",value:G,onChange:function(e){return J(e.target.value)}})),n.a.createElement(g.a,{item:!0,xs:12,sm:6},n.a.createElement(f.a,{fullWidth:!0,label:"Worker's Department",value:V,onChange:function(e){return H(e.target.value)}})),n.a.createElement(g.a,{item:!0,xs:12,sm:6},n.a.createElement(y.a,{utils:h.a},n.a.createElement(x.a,{disableToolbar:!0,fullWidth:!0,variant:"inline",format:"dd/MM/yyyy",label:"Start Date",value:Y,onChange:function(e){je.length||Q(e)},className:Me.errs.date?e.error:null}))),n.a.createElement(g.a,{item:!0,xs:12,sm:6},n.a.createElement(y.a,{utils:h.a},n.a.createElement(x.a,{disableToolbar:!0,fullWidth:!0,variant:"inline",format:"dd/MM/yyyy",label:"End Date",value:ee,onChange:function(e){je.length||ae(e)},className:Me.errs.date?e.error:null})))),n.a.createElement("div",{className:e.paper},n.a.createElement(b.a,{component:"h1",variant:"h5"},"Register Expense"),n.a.createElement("br",null),n.a.createElement(g.a,{container:!0,spacing:2},n.a.createElement(g.a,{item:!0,xs:12,sm:6},n.a.createElement(y.a,{utils:h.a},n.a.createElement(x.a,{disableToolbar:!0,fullWidth:!0,variant:"inline",format:"dd/MM/yyyy",label:"Date",value:ne,mask:"",onChange:function(e){Y&&Y<=e&&e<=ee&&re(e)}}))),n.a.createElement(g.a,{item:!0,xs:12,sm:6},n.a.createElement(f.a,{fullWidth:!0,label:"Description",value:ie||"Teste ",onChange:function(e){return ue(e.target.value)}})),n.a.createElement(g.a,{item:!0,xs:6,sm:3},n.a.createElement(f.a,{fullWidth:!0,label:"Cost",value:de,onChange:function(e){return fe(e.target.value)},error:!Re.test(de)&&"0.00"!=de})),n.a.createElement(g.a,{item:!0,xs:6,sm:3},n.a.createElement(f.a,{fullWidth:!0,label:"Multiplier",value:ve,type:"number",onChange:function(e){/^[1-9]\d*$/g.test(e.target.value)&&Ee(e.target.value)}})),n.a.createElement(g.a,{item:!0,xs:12,sm:6},n.a.createElement(O.a,{style:{fontSize:12}},"Category"),n.a.createElement(j.a,{fullWidth:!0,style:{padding:"5px 0 0 0"},value:Ce,onChange:function(e){return ye(e.target.value)}},n.a.createElement(W.a,{value:"Hotel"},"Hotel"),n.a.createElement(W.a,{value:"Transporte"},"Transporte"),n.a.createElement(W.a,{value:"Combust\xedvel"},"Combust\xedvel"),n.a.createElement(W.a,{value:"Alimenta\xe7\xe3o"},"Alimenta\xe7\xe3o"),n.a.createElement(W.a,{value:"Telefone"},"Telefone"),n.a.createElement(W.a,{value:"Entretenimento"},"Entretenimento"),n.a.createElement(W.a,{value:"Diversos"},"Diversos")))),n.a.createElement(d.a,{fullWidth:!0,variant:"contained",color:"primary",className:e.submit,onClick:function(e){return e.preventDefault(),Ne()&&(Oe([].concat(Object(s.a)(je),[{date:ne,description:ie,price:de,multiplier:ve,category:Ce}])),re(null),ue(""),fe("0.00"),Ee(1),ye("Alimenta\xe7\xe3o")),void console.log("Errors on submit: ",Me.errs)}},"Add Information")),je.length?n.a.createElement(g.a,{container:!0,style:{padding:"0 0 10px 0"},spacing:1},n.a.createElement(g.a,{item:!0,xs:2},n.a.createElement(f.a,{className:e.header,fullWidth:!0,variant:"filled",disabled:!0,defaultValue:"Data"})),n.a.createElement(g.a,{item:!0,xs:6},n.a.createElement(f.a,{className:e.header,fullWidth:!0,variant:"filled",disabled:!0,defaultValue:"Descri\xe7\xe3o"})),n.a.createElement(g.a,{item:!0,xs:2},n.a.createElement(f.a,{className:e.header,fullWidth:!0,variant:"filled",disabled:!0,defaultValue:"Custo"})),n.a.createElement(g.a,{item:!0,xs:1},n.a.createElement(f.a,{className:e.header,fullWidth:!0,variant:"filled",disabled:!0,defaultValue:"x"}))):null,je.map((function(a,t){return n.a.createElement(g.a,{container:!0,key:Object(w.uuid)(),spacing:1},n.a.createElement(g.a,{item:!0,xs:2},n.a.createElement(f.a,{className:e.tableRow,fullWidth:!0,variant:"filled",disabled:!0,defaultValue:R(a.date)})),n.a.createElement(g.a,{item:!0,xs:6},n.a.createElement(f.a,{className:e.tableRow,fullWidth:!0,variant:"filled",disabled:!0,defaultValue:a.description})),n.a.createElement(g.a,{item:!0,xs:2},n.a.createElement(f.a,{className:e.tableRow,fullWidth:!0,variant:"filled",disabled:!0,defaultValue:a.price})),n.a.createElement(g.a,{item:!0,xs:1},n.a.createElement(f.a,{className:e.tableRow,fullWidth:!0,variant:"filled",disabled:!0,defaultValue:a.multiplier})),n.a.createElement(g.a,{item:!0,xs:1},n.a.createElement(d.a,{onClick:function(e){return a=t,void Oe(je.filter((function(e,t){return t!==a})));var a},variant:"contained",color:"primary",className:e.deleteRow},n.a.createElement(C.a,null))))})),je.length?n.a.createElement(d.a,{fullWidth:!0,variant:"contained",color:"primary",className:e.submit,onClick:function(e){return Te()}},"Generate Excel File"):null)}var A=function(){return n.a.createElement(c.a,null,n.a.createElement("div",{className:"container"},n.a.createElement(i.a,{path:"/",exact:!0,component:T})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},90:function(e,a,t){e.exports=t(110)},95:function(e,a,t){},96:function(e,a,t){}},[[90,1,2]]]);
//# sourceMappingURL=main.8d939174.chunk.js.map